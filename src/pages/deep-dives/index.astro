---
import Item from "@/components/item.astro"
import Link from "@/components/link.astro"
import Layout from "@/layout/layout.astro"
import { getAllCategories } from "@/utils/content-categories.utils"
import { getDeepDives } from "@/utils/content-deep-dives.utils"

const deepDives = await getDeepDives()
const categories = await getAllCategories()
const crumbs: { title: string; href: string }[] = []
---

<Layout title="Deep Dives" description="Notes and explorations on system design, leadership, and DSA" {crumbs} pageType="default">
  <h1>Deep Dives</h1>
  <p class="mb-8 text-lg">
    A digital garden of notes, explorations, and learnings.
  </p>

  <!-- Category Overview -->
  <section class="mb-12">
    <h2 class="mb-4 text-2xl font-light">Browse by Category</h2>
    <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
      {
        categories.map((cat) => (
          <Link
            href={cat.href}
            class="sp-border-muted block rounded-lg border p-4 no-underline hover:bg-gray-50 dark:hover:bg-gray-800"
          >
            <h3 class="font-medium">{cat.name}</h3>
            <p class="text-muted-foreground text-sm">{cat.totalDeepDives} notes</p>
          </Link>
        ))
      }
    </div>
  </section>

  <!-- Recent Deep Dives -->
  <section>
    <h2 class="mb-4 text-2xl font-light">Recent Notes</h2>
    {
      deepDives.length > 0 ? (
        <ul class="flex flex-col">
          {deepDives.map((item) => (
            <Item item={item} />
          ))}
        </ul>
      ) : (
        <p class="text-muted-foreground">No notes yet. Check back soon!</p>
      )
    }
  </section>
</Layout>
