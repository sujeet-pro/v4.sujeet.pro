---
import { getCollection } from "astro:content"
import Link from "@/components/link.astro"

// Get all categories from unified collection
const allCategories = await getCollection("categories")

// Filter by post type and map to display format
const deepDivesCategories = allCategories
  .filter((c) => c.data.postType === "deep-dives")
  .map((c) => {
    const categoryId = c.id.split("/")[1] || c.id
    return { id: categoryId, title: c.data.title, name: c.data.name, href: `/posts/deep-dives/${categoryId}` }
  })

const notesCategories = allCategories
  .filter((c) => c.data.postType === "notes")
  .map((c) => {
    const categoryId = c.id.split("/")[1] || c.id
    return { id: categoryId, title: c.data.title, name: c.data.name, href: `/posts/notes/${categoryId}` }
  })
---

<footer class="site-footer">
  <div class="content-container site-footer-inner">
    {/* Category Links Grid */}
    <div class="site-footer-categories">
      <div class="site-footer-category-section">
        <h4 class="site-footer-category-title">
          <Link href="/posts/deep-dives" class="nav-link">Deep Dives</Link>
        </h4>
        <nav class="site-footer-category-links">
          {deepDivesCategories.map((cat) => (
            <Link href={cat.href} class="nav-link" title={cat.title}>{cat.name}</Link>
          ))}
        </nav>
      </div>
      <div class="site-footer-category-section">
        <h4 class="site-footer-category-title">
          <Link href="/posts/notes" class="nav-link">Notes</Link>
        </h4>
        <nav class="site-footer-category-links">
          {notesCategories.map((cat) => (
            <Link href={cat.href} class="nav-link" title={cat.title}>{cat.name}</Link>
          ))}
        </nav>
      </div>
    </div>

    <div class="site-footer-links">
      <nav class="site-footer-nav">
        <Link href="/posts" class="nav-link">All Posts</Link>
        <Link href="/tag" class="nav-link">Tags</Link>
        <Link href="/search" class="nav-link">Search</Link>
        <Link href="/cv" class="nav-link">Resume</Link>
        <Link href="/posts/drafts" class="nav-link">Drafts</Link>
        <Link href="/in-research" class="nav-link">In Research</Link>
      </nav>

      <div class="site-footer-social">
        <Link
          href="https://github.com/sujeet-pro"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="GitHub"
          title="GitHub"
          icon="devicon:github"
          class="nav-link"
        />
        <Link
          href="https://www.linkedin.com/in/sujeetkrjaiswal/"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="LinkedIn"
          title="LinkedIn"
          icon="devicon-plain:linkedin"
          class="nav-link"
        />
        <Link
          href="https://twitter.com/sujeetpro"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="Twitter"
          title="Twitter"
          icon="devicon:twitter"
          class="nav-link"
        />
      </div>
    </div>

    <p class="site-footer-copyright">
      &copy; {new Date().getFullYear()} Sujeet Jaiswal. All rights reserved.
    </p>
  </div>
</footer>
