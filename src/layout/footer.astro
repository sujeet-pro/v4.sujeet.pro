---
import { getCollection } from "astro:content"
import Link from "@/components/link.astro"

// Get all categories from unified collection
const allCategories = await getCollection("categories")

// Filter by post type and map to display format
const deepDivesCategories = allCategories
  .filter((c) => c.data.postType === "deep-dives")
  .map((c) => {
    const categoryId = c.id.split("/")[1] || c.id
    return { id: categoryId, title: c.data.title, name: c.data.name, href: `/posts/deep-dives/${categoryId}` }
  })

const notesCategories = allCategories
  .filter((c) => c.data.postType === "notes")
  .map((c) => {
    const categoryId = c.id.split("/")[1] || c.id
    return { id: categoryId, title: c.data.title, name: c.data.name, href: `/posts/notes/${categoryId}` }
  })

const allPostsLinks = [
  { href: "/search", name: "Search" },
  { href: "/tag", name: "Tags" },
  { href: "/posts/drafts", name: "Drafts" },
  { href: "/in-research", name: "In Research" },
]
---

<footer class="site-footer">
  <div class="content-container site-footer-inner">
    {/* Three Column Navigation Grid */}
    <div class="site-footer-columns">
      {/* Column 1: Deep Dives */}
      <div class="site-footer-column">
        <h4 class="site-footer-column-title">
          <Link href="/posts/deep-dives" class="nav-link">Deep Dives</Link>
        </h4>
        <nav class="site-footer-column-links">
          {deepDivesCategories.map((cat) => (
            <Link href={cat.href} class="nav-link" title={cat.title}>{cat.name}</Link>
          ))}
        </nav>
      </div>

      {/* Column 2: Notes */}
      <div class="site-footer-column">
        <h4 class="site-footer-column-title">
          <Link href="/posts/notes" class="nav-link">Notes</Link>
        </h4>
        <nav class="site-footer-column-links">
          {notesCategories.map((cat) => (
            <Link href={cat.href} class="nav-link" title={cat.title}>{cat.name}</Link>
          ))}
        </nav>
      </div>

      {/* Column 3: All Posts */}
      <div class="site-footer-column">
        <h4 class="site-footer-column-title">
          <Link href="/posts" class="nav-link">All Posts</Link>
        </h4>
        <nav class="site-footer-column-links">
          {allPostsLinks.map((link) => (
            <Link href={link.href} class="nav-link">{link.name}</Link>
          ))}
        </nav>
      </div>
    </div>

    {/* Horizontal Bar: Resume + Social */}
    <div class="site-footer-bar">
      <Link href="/cv" class="nav-link">Resume</Link>
      <div class="site-footer-social">
        <Link
          href="https://github.com/sujeet-pro"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="GitHub"
          title="GitHub"
          icon="devicon:github"
          class="nav-link"
        />
        <Link
          href="https://www.linkedin.com/in/sujeetkrjaiswal/"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="LinkedIn"
          title="LinkedIn"
          icon="devicon-plain:linkedin"
          class="nav-link"
        />
        <Link
          href="https://twitter.com/sujeetpro"
          target="_blank"
          rel="noopener noreferrer"
          aria-label="Twitter"
          title="Twitter"
          icon="devicon:twitter"
          class="nav-link"
        />
      </div>
    </div>

    {/* Copyright */}
    <p class="site-footer-copyright">
      &copy; {new Date().getFullYear()} Sujeet Jaiswal. All rights reserved.
    </p>
  </div>
</footer>
